<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Il.Literate</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
    <div class="container-fluid">
        <nav class="navbar navbar-expand-lg bg-primary front-width">
            <div class="container-fluid">
              <a class="navbar-brand" href="#">Navbar</a>
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                  <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="#">Home</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">Link</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
          <div class="row justify-content-between">
            <div class="col-3 bg-dark">
                One of two columns
            </div>
            <div class="col-3 bg-dark">
                <div>
                    <!-- <img src="../../../assets/Chat-bot.jpeg" style="height:100px;width:100px" class="rounded float-end m-2"
                        alt="Bot Image"> -->
                </div>
                <div>
                    <p class="p-2 m-2 text-light bg-secondary rounded">How can I help you?</p>
                </div>
                <form id="backend_form" method="post">
                  {% csrf_token %}
                    <div class="input-group mb-3">
                        <input id = "backend_form_input" type="text" class="form-control" placeholder="Enter Your Query" aria-label="Recipient's username"
                            aria-describedby="button-addon2" name="query" ngModel>
                        <button class="btn btn-outline-primary" type="submit" id="button-addon2">Submit</button>
                    </div>
                </form>
                <div>
                    <div class="text-light p-2 m-1" id="backend_botchat">
                      
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script>
  $('#backend_form').submit(function(e){
    e.preventDefault();

    var input_field = document.getElementById("backend_form_input");
    var input_value = $("#backend_form_input").val();
    var div_message = document.getElementById("backend_botchat");
    div_message.innerHTML="";
     $.ajax({
        type:"POST",
        url:"/bot",
        data:{
                comd:input_value,
                csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
            },
        
        success:function(response){

          //Not getting data
          if(response.code == 0)
          {
            var message = response.message;
            var inst = response.instruction;
            var msg = input_value; 
            div_message.innerHTML += `<h3>${inst}</h3><h2 style="color:red;">${message}</h2>`;
            
          }

          //help command
          else if(response.code == 1)
          {
            var message = response.message;
            var help_command = response.help;
            div_message.innerHTML += `<h5>${input_value}</h5>`;
            help_command.forEach(element => {
              div_message.innerHTML += `<h7 style="color:red;">${element.command}:</h7><h7> ${element.description}</h7><br>`;
            });
           
          }


          //search content
          else if(response.code == 2)
          {
          
            var answers = response.answer;
            var inst = response.instruction;

            div_message.innerHTML += `<h3>${inst}</h3>`
            answers.forEach(element => {
              div_message.innerHTML += `<h7 style="color:red;">Course Name</h7><h7>${element.course_name}</h7><br><h7 style="color:red;">URL</h7><h7><a href="${element.url}">${element.url}</a></h7><br><h7 style="color:red;">Platform</h7><h7>${element.platform}</h7><br><h7 style="color:red;">Offered By</h7><h7>${element.instructor}</h7><br><h7 style="color:red;">Price</h7><h7>${element.price}</h7><br><br>`;
            });
          }




          //fun_chat
          else if(response.code == 3)
          {
            var answer = response.ans;
            var inst = response.instruction;
            div_message.innerHTML += `<h3>${inst}</h3>`
            div_message.innerHTML += `<h4>${answer}</h4>`


          }


          //Making input field null
          input_field.value = '';
        },
        error: function(response){}
     });
  });
</script>

</html>